<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disaster Alert</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        h1 {
            text-align: center;
            margin-top: 20px;
            color: #000000;
        }
        #container {
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
        }
        .alert-box {
            display: none; /* Hidden by default */
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .alert-box h2 {
            margin-top: 0;
        }
        .alert-box button {
            background-color: #f5c6cb;
            border: none;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .alert-box button:hover {
            background-color: #f1b0b7;
        }
        pre {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            margin: 0;
            white-space: pre-wrap; /* Allows for wrapping in preformatted text */
        }
    </style>
</head>
<body>
    <h1>Disaster Alert</h1>
    <div id="container">
        <div class="alert-box" id="disaster-alert">
            <h2>Alert: Current Disaster</h2>
            <p id="alert-message">No active disaster alert.</p>
            <button onclick="closeAlert()">Close</button>
        </div>
        <div class="section" id="event-details-section">
            <h2>Event Details</h2>
            <pre id="event-details"></pre>
        </div>
        <div class="section" id="weather-details-section">
            <h2>Weather Details</h2>
            <pre id="weather-details"></pre>
        </div>
    </div>

    <script>
        // Event type to description mapping
        const eventTypeDescriptions = {
            EQ: 'Earthquakes and related seismic activities',
            TC: 'Tropical cyclones, including hurricanes, typhoons, and cyclones',
            WF: 'Wildfires and related fire events. Includes wildfires, burn off, bushfire, fires, pre fire alerts, structure fire',
            FL: 'Floods, including flash floods and general flooding',
            ET: 'Extreme temperature events, including heat waves, cold waves, hot day conditions, etc',
            DR: 'Droughts and prolonged dry conditions',
            SW: 'Severe storms, thunderstorms, and related weather phenomena. Includes lightning, gusty winds, thunder shower, violent wind, storm surge, lightning, hailstorm, heavy Rain and light Rain',
            SI: 'Sea ice conditions',
            VO: 'Volcanic activities and eruptions',
            LS: 'Landslides, avalanches, and related ground movement',
            TN: 'Tsunamis and related sea waves',
            Misc: 'Miscellaneous events, including unique imagery and technical disasters'
        };

        // Function to fetch event details
        function fetchEventDetails() {
            fetch('/event')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('event-details').textContent = JSON.stringify(data, null, 2);

                    // Check if there is an active disaster and show alert
                    if (data.result && data.result.length > 0) {
                        const disaster = data.result[0];
                        const eventType = eventTypeDescriptions[disaster.event_type] || 'Unknown event type';
                        const message = `Event Type: ${eventType}\nEvent Name: ${disaster.event_name}\nDate: ${disaster.date}\nMagnitude: ${disaster.details ? disaster.details.event_magnitude : 'N/A'}`;
                        document.getElementById('alert-message').textContent = message;
                        document.getElementById('disaster-alert').style.display = 'block';
                    } else {
                        document.getElementById('disaster-alert').style.display = 'none';
                    }
                })
                .catch(error => console.error('Error fetching event details:', error));
        }

        // Function to fetch weather details
        function fetchWeatherDetails() {
            fetch('/weather')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('weather-details').textContent = JSON.stringify(data, null, 2);
                })
                .catch(error => console.error('Error fetching weather details:', error));
        }

        // Function to close the alert box
        function closeAlert() {
            document.getElementById('disaster-alert').style.display = 'none';
        }

        // Fetch details when the page loads
        window.onload = function() {
            fetchEventDetails();
            fetchWeatherDetails();
        };
    </script>
</body>
</html>
